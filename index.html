<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Car Rental App</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <h1>Rent Your Next Ride</h1>
    <button id="admin-login">Login as Admin</button>
</header>

<main>
    <section id="admin-section" style="display:none;">
        <h2>Add New Car</h2>
        <form id="add-car-form">
            <input type="text" id="make" placeholder="Make" required>
            <input type="text" id="model" placeholder="Model" required>
            <input type="number" id="year" placeholder="Year" required>
            <input type="number" id="price" placeholder="Rental Price/Day" required>
            <input type="text" id="image" placeholder="Image URL" required>
            <button type="submit">Add Car</button>
        </form>
    </section>

    <section id="car-container" class="car-list">
        <!-- Car cards will be inserted here dynamically -->
    </section>
</main>

<footer>
    <p>&copy; 2025 Car Rental App</p>
</footer>

<script>
let isAdmin = false;

document.getElementById('admin-login').addEventListener('click', function() {
    const password = prompt('Enter Admin Password:');
    if (password === 'admin123') {
        isAdmin = true;
        document.getElementById('admin-section').style.display = 'block';
        loadCars();
    } else {
        alert('Wrong password!');
    }
});

document.getElementById('add-car-form').addEventListener('submit', function(e) {
    e.preventDefault();
    const newCar = {
        make: document.getElementById('make').value,
        model: document.getElementById('model').value,
        year: document.getElementById('year').value,
        rental_price_per_day: document.getElementById('price').value,
        image_url: document.getElementById('image').value
    };
    fetch('http://127.0.0.1:5000/add_car', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(newCar)
    })
    .then(res => res.json())
    .then(data => {
        alert(data.message);
        document.getElementById('add-car-form').reset();
        loadCars();
    });
});

function loadCars() {
    fetch('http://127.0.0.1:5000/get_cars')
        .then(response => response.json())
        .then(cars => {
            const container = document.getElementById('car-container');
            container.innerHTML = '';
            cars.forEach(car => {
                const carCard = document.createElement('div');
                carCard.className = 'car-card';
                carCard.innerHTML = `
                    <img src="${car.image_url}" alt="${car.make} ${car.model}">
                    <h2>${car.make} ${car.model}</h2>
                    <p>Year: ${car.year}</p>
                    <p>Rental Price: $${car.rental_price_per_day}/day</p>
                    <button onclick="rentCar(${car.id})">Rent Now</button>
                    ${isAdmin ? `<button onclick="deleteCar(${car.id})" class="delete-btn">Delete Car</button>` : ''}
                `;
                container.appendChild(carCard);
            });
        });
}

function rentCar(id) {
    fetch('http://127.0.0.1:5000/rent_car/' + id, {
        method: 'POST'
    })
    .then(res => res.json())
    .then(data => {
        alert(data.message);
        loadCars();
    });
}

function deleteCar(id) {
    if (confirm('Are you sure you want to delete this car?')) {
        fetch('http://127.0.0.1:5000/delete_car/' + id, {
            method: 'DELETE'
        })
        .then(res => res.json())
        .then(data => {
            alert(data.message);
            loadCars();
        });
    }
}

loadCars();
</script>

</body>
</html>
